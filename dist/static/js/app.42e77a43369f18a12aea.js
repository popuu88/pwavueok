webpackJsonp([1],[,,,function(e,t,s){"use strict";t.a={name:"app"}},function(e,t,s){"use strict";var a=firebase.database().ref("/messages/"),o=firebase.storage().ref("/images/");t.a={name:"ChatRoom",data:function(){return{userNameSet:!1,userName:"",messages:[],upload:!1,progress:""}},methods:{setName:function(){this.userNameSet=!0},saveName:function(){var e=this,t=document.querySelector("#js-userName").value;""!=t.trim()&&(e.userName=t,e.userNameSet=!1)},getTime:function(){var e=new Date,t=e.getHours(),s=e.getMinutes();return(t>=12?"下午":"上午")+" "+t+":"+(s<10?"0"+s:s)},sendMessage:function(e){var t=this,s=document.querySelector("#js-userName"),o=document.querySelector("#js-message");return!e.shiftKey&&(o.value.length<=1&&""==o.value.trim()?(e.preventDefault(),!1):(a.push({userName:s.value,type:"text",message:o.value,timeStamp:t.getTime()}),o.value="",void e.preventDefault()))},sendImage:function(e){var t=this,s=document.querySelector("#js-userName"),r=e.target.files[0],i=Math.floor(Date.now()/1e3)+"_"+r.name,n={contentType:"image/*"},m=document.querySelector("#js-progressBar"),u=o.child(i).put(r,n);u.on(firebase.storage.TaskEvent.STATE_CHANGED,function(e){var s=Math.floor(e.bytesTransferred/e.totalBytes*100);s<100&&(t.upload=!0,t.progress=s+"%",m.setAttribute("style","width:"+s+"%"))},function(e){a.child("bug/").push({userName:s.value,type:"image",message:e.code,timeStamp:t.getTime()})},function(){var e=u.snapshot.downloadURL;a.push({userName:s.value,type:"image",message:e,timeStamp:t.getTime()}),t.upload=!1})},readMore:function(e){e.target.previousElementSibling.setAttribute("style","max-height: 100%;"),e.target.setAttribute("style","display: none;")}},mounted:function(){var e=this;a.on("value",function(t){var s=t.val();e.messages=s})},updated:function(){document.querySelectorAll(".messageBox__message").forEach(function(e){e.offsetHeight>300&&e.querySelector(".messageBox__readMore").setAttribute("style","display: block")});var e=document.querySelector("#js-roomBody");e.scrollTop=e.scrollHeight}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1),o=s(9),r=s(13);a.a.config.productionTip=!1,new a.a({el:"#app",router:r.a,template:"<App/>",components:{App:o.a}})},,,,function(e,t,s){"use strict";function a(e){s(10)}var o=s(3),r=s(12),i=s(2),n=a,m=i(o.a,r.a,!1,n,null,null);t.a=m.exports},function(e,t){},,function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},o=[],r={render:a,staticRenderFns:o};t.a=r},function(e,t,s){"use strict";var a=s(1),o=s(14),r=s(15);a.a.use(o.a),t.a=new o.a({routes:[{path:"/",name:"ChatRoom",component:r.a}]})},,function(e,t,s){"use strict";function a(e){s(16)}var o=s(4),r=s(17),i=s(2),n=a,m=i(o.a,r.a,!1,n,"data-v-273fa103",null);t.a=m.exports},function(e,t){},function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"name"}),e._v(" "),s("div",{staticClass:"chatRoom"},[e._m(0),e._v(" "),s("div",{staticClass:"roomBody",attrs:{id:"js-roomBody"}},[e._l(e.messages,function(t){return[t.userName!=e.userName?[s("div",{staticClass:"messageBox"},[s("div",{staticClass:"messageBox__content"},["text"==t.type?s("div",{staticClass:"messageBox__message"},[s("div",{staticClass:"messageBox__text"},[e._v(e._s(t.message))]),e._v(" "),s("div",{staticClass:"messageBox__readMore",on:{click:function(t){e.readMore(t)}}},[e._v("顯示更多")])]):e._e(),e._v(" "),"image"==t.type?s("div",{staticClass:"messageBox__image"},[s("img",{attrs:{src:t.message}})]):e._e()])])]:e._e(),e._v(" "),t.userName==e.userName?[s("div",{staticClass:"messageBox messageBox--self"},[s("div",{staticClass:"messageBox__content"},["text"==t.type?s("div",{staticClass:"messageBox__message"},[s("div",{staticClass:"messageBox__text"},[e._v(e._s(t.message))])]):e._e(),e._v(" "),"image"==t.type?s("div",{staticClass:"messageBox__image"},[s("img",{attrs:{src:t.message}})]):e._e()])])]:e._e()]}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.upload,expression:"upload"}],staticClass:"messageBox messageBox--self"},[s("div",{staticClass:"messageBox__progress"},[s("div",{staticClass:"messageBox__progress--state",attrs:{id:"js-progressBar"}}),e._v(" "),s("div",{staticClass:"messageBox__progress--number"},[e._v(e._s(e.progress))])])])],2),e._v(" "),s("div",{staticClass:"roomBottom",class:{disable:!e.userName}},[s("div",{staticClass:"roomBottom__tools"},[s("div",{staticClass:"roomBottom__tools_upload"},[s("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(t){e.sendImage(t)}}})])]),e._v(" "),s("div",{staticClass:"roomBottom__input"},[s("textarea",{staticClass:"roomBottom__input__textarea",class:{disable:!e.userName},attrs:{id:"js-message"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.sendMessage(t)}}})])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.userNameSet||""==e.userName,expression:"userNameSet || userName == ''"}],staticClass:"modal"},[s("div",{staticClass:"modal__container"},[e._m(1),e._v(" "),s("div",{staticClass:"modal__body"},[s("input",{staticClass:"userName",attrs:{type:"text",id:"js-userName",maxlength:"6"},domProps:{value:e.userName},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.saveName()}}}),e._v(" "),s("div",{staticClass:"button",on:{click:function(t){e.saveName()}}},[e._v("設定")])]),e._v(" "),s("footer",{staticClass:"modal__footer"})])])])},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"roomHead"},[s("div",{staticClass:"roomHead__topButtons"},[s("div",{staticClass:"roomHead__button close"}),e._v(" "),s("div",{staticClass:"roomHead__button minimize"}),e._v(" "),s("div",{staticClass:"roomHead__button zoom"})]),e._v(" "),s("img",{staticClass:"roomHead__img",attrs:{src:"https://lorempixel.com/50/50/",draggable:"false"}}),e._v(" "),s("div",{staticClass:"roomHead__title"},[e._v("Test Room")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"modal__header"},[s("h2",{staticClass:"view-title"},[e._v("輸入名稱")])])}],r={render:a,staticRenderFns:o};t.a=r}],[5]);
//# sourceMappingURL=app.42e77a43369f18a12aea.js.map